# Version 38 使用和测试指南

## 快速开始

### 1. 创建一个完整的工作流

#### 步骤1：创建输入节点
1. 点击左侧工具栏的"输入"图标（📝）
2. 在画布上点击放置节点
3. 在文本框中输入：
   ```
   一台复古风格的绿色意式咖啡机
   放在木质桌面上
   旁边有咖啡豆和咖啡杯
   温暖的自然光线
   ```

4. 观察节点高度自动增加以适应文本内容

#### 步骤2：上传参考图片（可选）
1. 点击"上传图片 (0/3)"按钮
2. 选择1-3张参考图片
3. 观察：
   - 计数更新为 (1/3)、(2/3)、(3/3)
   - 图片以3列网格布局显示
   - 达到3张后按钮显示禁用状态

#### 步骤3：连接到图片生成节点
1. 将鼠标移到输入节点右侧的圆形端口
2. 点击并拖动鼠标向右
3. 会出现白色菜单，显示"图片"和"视频"选项
4. 点击"图片"
5. 自动创建图片生成节点并建立连接

#### 步骤4：配置图片生成参数
在图片生成节点中：
- **模型**: 选择 Seedream 4（或其他模型）
- **模式**: 选择 Auto
- **数量**: 选择生成数量（1-4张）
- **比例**: 选择宽高比（如1:1方形）

#### 步骤5：执行生成
1. 点击"执行 ⚡1"按钮
2. 打开浏览器控制台（按F12）
3. 观察输出：
   ```
   生成图片使用的提示词: 一台复古风格的绿色意式咖啡机...
   参考图片数量: 3
   ```
4. 等待2-3秒，生成的图片会显示在节点下方

#### 步骤6：链式创建（继续创作）
1. 将鼠标悬停在生成的图片上
2. 会出现半透明遮罩和"继续创作"按钮
3. 点击"继续创作"
4. 自动创建：
   - 新的输入节点（包含当前图片）
   - 新的图片生成节点
   - 两者之间的连接
5. 视图自动缩放到新节点

### 2. 创建视频生成工作流

#### 方法1：从文本输入创建视频
1. 创建输入节点，输入文字描述
2. 连接到"视频"节点（拖动端口时选择）
3. 配置视频参数（模型、时长、比例）
4. 执行生成

#### 方法2：从图片创建视频
1. 先生成图片（参考上面的步骤）
2. 从图片生成节点的输出端口拖出连接
3. 选择"视频"
4. 视频生成会基于图片内容创建
5. 控制台会显示：
   ```
   生成视频使用的提示词: 基于生成的图片创建视频
   参考图片数量: 4
   ```

## 功能测试清单

### ✅ 文本框自动调整测试

- [ ] 输入1行文字，节点保持紧凑（约60px高）
- [ ] 输入5-10行文字，节点高度增加
- [ ] 输入超过15行文字，节点达到最大高度（280px）
- [ ] 删除部分文字，节点高度自动缩小

### ✅ 图片上传限制测试

- [ ] 上传第1张图片，显示"(1/3)"
- [ ] 上传第2张图片，显示"(2/3)"
- [ ] 上传第3张图片，显示"(3/3)"
- [ ] 尝试上传第4张，弹出提示"最多只能上传3张图片"
- [ ] 删除一张图片，计数减少，上传按钮恢复可用
- [ ] 3张图片以3列网格布局显示

### ✅ 执行逻辑关联测试

- [ ] 输入节点有文字时，执行后控制台显示提示词
- [ ] 输入节点有图片时，控制台显示图片数量
- [ ] 从图片节点连接到视频节点，能获取生成的图片
- [ ] 链式创建时，新输入节点包含上一个生成的内容

### ✅ 链式创建测试

- [ ] 悬停图片时显示"继续创作"按钮
- [ ] 点击后自动创建新节点
- [ ] 新节点正确定位在下方
- [ ] 视图自动缩放到新节点
- [ ] 可以多次链式创建

## 已知问题和限制

### 当前使用模拟数据
- 生成的图片来自 picsum.photos 随机图片服务
- 生成的视频使用示例视频
- **不是**基于实际提示词和参考图片生成的真实内容
- 但提示词和图片已正确获取并记录在控制台

### 控制台日志的作用
打开控制台（F12）可以看到：
1. 每次执行时使用的提示词
2. 参考图片的数量
3. 这证明输入内容已正确传递到生成节点

### 下一步：集成真实AI
要使用真实AI生成：
1. 配置API密钥（在`.env`文件）
2. 修改execute方法调用真实API
3. 将提示词和参考图片传递给API
4. 处理API响应并显示真实生成结果

## 常见问题

### Q: 为什么生成的图片跟我的提示词无关？
**A**: 当前版本使用模拟数据。提示词已正确获取（可在控制台查看），但还未连接到真实AI API。这将在下一个版本中实现。

### Q: 如何查看输入内容是否正确传递？
**A**: 按F12打开浏览器控制台，执行生成时会输出：
```
生成图片使用的提示词: [你输入的文字]
参考图片数量: [你上传的图片数量]
```

### Q: 文本框可以无限增长吗？
**A**: 不可以，最大高度限制为280px。超过此高度会出现滚动条。

### Q: 为什么只能上传3张图片？
**A**: 这是根据用户需求设定的限制，符合大多数AI图片生成工具的参考图片数量要求。

### Q: 删除图片后为什么节点高度没变？
**A**: 节点高度会根据图片数量动态调整。如果看起来没变，可能是因为：
1. 还有其他图片占位
2. 文本框的高度影响了总高度
3. 刷新页面可以重新计算高度

## 性能提示

- **大量文字**: 如果输入非常长的文字，节点会变大，可能影响画布性能
- **多个节点**: 创建大量节点（50+）可能会影响流畅度
- **图片大小**: 上传的图片会转为base64存储，建议每张图片不超过5MB

## 下一步探索

尝试创建更复杂的工作流：
1. **多步骤生成**: 文本 → 图片 → 视频
2. **并行生成**: 一个输入连接多个图片生成节点
3. **迭代优化**: 使用链式创建多次优化同一主题
4. **风格探索**: 使用不同的模型和参数对比效果

享受创作！🎨
